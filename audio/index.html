<!DOCTYPE html>
<html>
<head>
	<title>zzfx</title>
</head>
 <style>
        body, html {background-color: #222; color: #fff; 
            user-select:none;
            margin: 0; padding: 0; font-family: monospace;}
        body {width:100%; height: 100%;}
        #joy {position: absolute; top: 0; left: 0; z-index: 99; width:100%; height: 100%;}
 </style>
<body>
<div id="joy"></div>

<!-- <button onclick="clicksnd()">x</button> -->

<script src="js/nipple.min.js"></script>


<script type="text/javascript">
'use strict';
var freq = 1;
var sinfreq = 0;
var lerpxvar = 0;
var lerpyvar = 0;
var yvar = 0;
var xvar = 0;
let zzfx,zzfxV,zzfxX

// ZzFXMicro - Zuper Zmall Zound Zynth 
zzfxV=.1 // volume
zzfx=    // play sound
(t=1,a=.05,n=220,e=0,f=0,h=.1,M=0,r=1,z=0,o=0,i=0,s=0,u=0,x=0,c=0,d=0,X=0,b=1,m=0,l=44100,B=99+e*l,C=f*l,P=h*l,g=m*l,w=X*l,A=2*Math.PI,D=(t=>0<t?1:-1),I=B+g+C+P+w|0,S=(z*=500*A/l**2),V=(n*=(1+2*a*Math.random()-a)*A/l),j=D(c)*A/4,k=0,p=0,q=0,v=0,y=0,E=0,F=1,G=[],H=zzfxX.createBufferSource(),J=zzfxX.createBuffer(1,I,l))=>{for(H.connect(zzfxX.destination);q<I;G[q++]=E)++y>100*d&&(y=0,E=k*n*Math.sin(p*c*A/l-j),E=D(E=M?1<M?2<M?3<M?Math.sin((E%A)**3):Math.max(Math.min(Math.tan(E),1),-1):1-(2*E/A%2+2)%2:1-4*Math.abs(Math.round(E/A)-E/A):Math.sin(E))*Math.abs(E)**r*t*zzfxV*(q<B?q/B:q<B+g?1-(q-B)/g*(1-b):q<B+g+C?b:q<I-w?(I-q-w)/P*b:0),E=w?E/2+(w>q?0:(q<I-w?1:(q-I)/w)*G[q-w|0]/2):E),k+=1-x+1e9*(Math.sin(q)+1)%2*x,p+=1-x+1e9*(Math.sin(q)**2+1)%2*x,n+=z+=500*o*A/l**3,F&&++F>s*l&&(n+=i*A/l,V+=i*A/l,F=0),u&&++v>u*l&&(n=V,z=S,v=1,F=F||1);return J.getChannelData(0).set(G),H.buffer=J,H.start(),H},zzfxX=new(window.AudioContext||webkitAudioContext)



	// click press sound
function clicksnd() {
	freq += 0.1;
	// sinfreq = Math.sin(freq*20)*20;
	// if (freq>100) {freq=1;}
	sinfreq = Math.sin(freq*20)/100

	// zzfx(...[2.04,,1348,.01,.01,.15,,.82,,,-52,.01,,,,.1,.07,.8,.01]); // Pickup 171
	// zzfx(...[2.04,0,freq,.01,.07,.15,,.82,,,-52,.01,,,,.1,.07,.8,.01]); // Loaded Sound 87
	//	zzfx(...[1.19,0,sinfreq,.01,.18,.02,,.96,,-5,-199,.39,,,-160,,.01,,.01]); // Blip 97
	zzfx(...[,0,117,sinfreq,.19,.44,1,.77,,,,,.09,,,,,.56,.25]); // Powerup 123

}

//
// nipple.js
const nipple = nipplejs.create({
	// zone: document.body,
	zone: document.getElementById('joy'),
	mode: 'dynamic',
	dataOnly:true,
});

// start
nipple.on("move", (e, data) => {
	var xx = data.force * Math.cos(data.angle.radian);
	var yy = -data.force * Math.sin(data.angle.radian);
	lerpxvar = 1+(xx/10);
	lerpyvar = 1+(yy/10);

	// var thisangle = data.angle.radian*4;
	// xmultiplier = (Math.random()/100);
	// console.log(lerpxvar, lerpyvar)
	// zzfx(...[,0,lerpxvar/100,lerpyvar,.19,.44,1,.77,,,,,.09,,,,,.56,.25]);
	zzfx(...[,0,lerpyvar*200,lerpxvar/50,.19,.44,1,.77,,,,,.09,,,,,.56,.25]);
});



// // end
// nipple.on("end", (e, data) => {
//   console.log(xvar,yvar,multiplier)
// });


</script>
</body>
</html>